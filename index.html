<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helping Learn Chatbot</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body { font-family: 'Poppins', sans-serif; }
.chat-open { animation: fadeIn 0.4s ease forwards; }
@keyframes fadeIn {
from { transform: scale(0.9); opacity: 0; }
to { transform: scale(1); opacity: 1; }
}
.typing-dots span {
display: inline-block;
width: 6px; height: 6px;
margin: 0 2px; background: #4B5563;
border-radius: 50%; animation: bounce 1.2s infinite;
}
.typing-dots span:nth-child(2){ animation-delay:0.2s }
.typing-dots span:nth-child(3){ animation-delay:0.4s }
@keyframes bounce {0%,80%,100%{transform:scale(0);}40%{transform:scale(1);} }
</style>
</head>
<body class="bg-gray-100">

<!-- Gif Button -->
<div id="gif-container" class="fixed bottom-5 left-5 z-50"></div>

<!-- Chat Screen -->
<div id="chatScreen" class="hidden fixed inset-0 flex items-center justify-center z-40 px-2">
<div class="w-full max-w-md max-h-[90vh] bg-white rounded-2xl shadow-xl flex flex-col overflow-hidden chat-open">

<!-- Banner -->
<div class="w-full">
<img src="https://helpinglearn.lovestoblog.com/wp-content/uploads/2025/08/Kawalan-science-Classroom-Banner.png"
alt="Banner" class="w-full h-24 sm:h-28 object-cover">
</div>

<!-- Messages -->
<div id="chatMessages" class="flex-1 overflow-y-auto p-3 bg-gray-50 text-sm"></div>

<!-- Input -->
<div class="p-3 bg-white border-t">
<div class="flex space-x-2">
<input type="text" id="userInput"
class="flex-1 rounded-full border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
placeholder="Ask me anything... (try: hi, courses)">
<button onclick="sendMessage()"
class="px-4 py-2 rounded-full bg-blue-500 text-white text-sm hover:bg-blue-600">Send</button>
</div>
</div>
</div>
</div>

<script>
// Helping Learn dataset
const helpingLearnData = {
"site_name": "Helping Learn",
"tagline": "Inspiring Minds Building Futures",
"services": [
"PDF-E-BOOKS",
"FREE CERTIFICATION COURSES",
"YOUTUBE COURSES"
],
"certificates": [
"Amazing Google Free Certificates",
"Free Microsoft Certificate",
"IBM Skill Build Free Certificates"
],
"courses": {
"gallery": [
"Free HTML Web Course In Hindi",
"CSS",
"JAVA",
"PYTHON",
"Free IOT Course",
"C#"
]
},
"ebooks": [
"C Books",
"Java Books",
"Python Books",
"PHP Books"
],
"contact": {
"email": "helpinglearn1@gmail.com",
"location": "Find Us",
"join": "Join Us"
},
"about": {
"description": "At HelpingLearn, we are committed to transforming the way people learn..."
}
};

// Gif rotation
const gifs = [
"https://helpinglearn.lovestoblog.com/wp-content/uploads/2025/08/Untitled-design.gif",
"https://helpinglearn.lovestoblog.com/wp-content/uploads/2025/08/123.gif",
"https://helpinglearn.lovestoblog.com/wp-content/uploads/2025/08/1.gif"
];
const gifContainer = document.getElementById("gif-container");
const chatScreen = document.getElementById("chatScreen");

function showRandomGif() {
const randomGif = gifs[Math.floor(Math.random() * gifs.length)];
gifContainer.innerHTML = `<img src="${randomGif}"
alt="Chatbot Gif"
class="w-16 h-16 sm:w-20 sm:h-20 cursor-pointer hover:scale-110 transition-transform"
onclick="toggleChat()">`;
}
showRandomGif(); setInterval(showRandomGif, 3000);

function toggleChat() {
chatScreen.classList.toggle("hidden");
}

// Chatbot main logic
async function sendMessage() {
const input = document.getElementById("userInput");
const message = input.value.trim();
if (!message) return;

const chatBox = document.getElementById("chatMessages");
chatBox.innerHTML += `
<div class="text-right my-2">
<span class="inline-block bg-blue-500 text-white px-3 py-2 rounded-lg text-sm">${message}</span>
</div>`;
input.value = "";
chatBox.scrollTop = chatBox.scrollHeight;

// Typing effect
const typingId = "typing-" + Date.now();
chatBox.innerHTML += `
<div id="${typingId}" class="text-left my-2 typing-dots">
<span></span><span></span><span></span>
</div>`;
chatBox.scrollTop = chatBox.scrollHeight;

let botReply = null;
const lower = message.toLowerCase();

// Local dataset answers
if (["hi","hello","hey"].includes(lower)) {
botReply = "Hello! Welcome to Helping Learn. How can I help you today?";
} else if (lower.includes("services")) {
botReply = "Our services are: " + helpingLearnData.services.join(", ");
} else if (lower.includes("courses")) {
botReply = "Available courses: " + helpingLearnData.courses.gallery.join(", ");
} else if (lower.includes("certificates")) {
botReply = "We offer: " + helpingLearnData.certificates.join(", ");
} else if (lower.includes("ebooks")) {
botReply = "Our eBooks: " + helpingLearnData.ebooks.join(", ");
} else if (lower.includes("contact")) {
botReply = `Email: ${helpingLearnData.contact.email}, Location: ${helpingLearnData.contact.location}, Join: ${helpingLearnData.contact.join}`;
} else if (lower.includes("about")) {
botReply = helpingLearnData.about.description;
}

// If no dataset reply -> Ask Gemini AI
if (!botReply) {
botReply = await askAI(message);
}

// Clean markdown asterisks from AI reply
botReply = botReply.replace(/\*/g, "");

// Remove typing dots
document.getElementById(typingId).remove();

const isLong = botReply.length > 300;
const replyId = "reply-" + Date.now();

chatBox.innerHTML += `
<div class="text-left my-2">
<span id="${replyId}" class="inline-block bg-gray-200 text-gray-800 px-3 py-2 rounded-lg text-sm">${botReply}</span>
${isLong ? `<button onclick="downloadPDF('${replyId}')" class="ml-2 text-blue-600 underline text-xs">Download PDF</button>` : ""}
</div>`;
chatBox.scrollTop = chatBox.scrollHeight;
}

// Gemini AI Fallback
async function askAI(query) {
try {
const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyBZi2Gqg6b5IN_hs511ZYtGKpi2lHa-YDE", {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify({
contents: [ { parts: [ { text: query } ] } ]
})
});
const data = await response.json();
return data.candidates?.[0]?.content?.parts?.[0]?.text || "No response from Gemini.";
} catch (err) {
return "Sorry, I couldnâ€™t fetch an answer right now.";
}
}

// Download reply as PDF (Note format with @Helping Learn)
function downloadPDF(replyId) {
const { jsPDF } = window.jspdf;
const doc = new jsPDF();
const text = document.getElementById(replyId).innerText;

// Title
doc.setFont("helvetica", "bold");
doc.setFontSize(16);
doc.text("Helping Learn - Notes", 105, 20, { align: "center" });

// Content
doc.setFont("helvetica", "normal");
doc.setFontSize(12);
const splitText = doc.splitTextToSize(text, 180);
doc.text(splitText, 15, 40);

// Footer
doc.setFontSize(10);
doc.text("@Helping Learn", 105, 290, { align: "center" });

doc.save("HelpingLearn-Notes.pdf");
}
</script>
</body>
</html>
